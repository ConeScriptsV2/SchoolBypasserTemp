<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Proxy Browser</title>

<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  background:#0f0f0f;
  color:#fff;
  overflow:hidden;
}

#Bar{
  display:flex;
  padding:10px;
  background:#181818;
  align-items:center;
  gap:8px;
  box-shadow:0 2px 10px rgba(0,0,0,0.4);
}

#UrlInput{
  flex:1;
  padding:10px;
  font-size:14px;
  background:#222;
  border:1px solid #333;
  border-radius:6px;
  color:#fff;
  outline:none;
}

#UrlInput:focus{
  border-color:#555;
}

#GoBtn{
  padding:10px 16px;
  background:#2d2d2d;
  border:none;
  border-radius:6px;
  color:#fff;
  cursor:pointer;
  transition:0.15s;
}

#GoBtn:hover{
  background:#3a3a3a;
}

#Frame{
  width:100%;
  height:calc(100vh - 60px);
  border:none;
  background:#fff;
}
</style>
</head>

<body>

<div id="Bar">
<input id="UrlInput" placeholder="Enter URL or paste link">
<button id="GoBtn">Go</button>
</div>

<iframe id="Frame"></iframe>

<script>
const ProxyBase="https://urlp-roxy.vercel.app/api/proxy?url="
const UrlInput=document.getElementById("UrlInput")
const GoBtn=document.getElementById("GoBtn")
const Frame=document.getElementById("Frame")

// Temporary cookie jar (clears on refresh)
let CookieJar = JSON.parse(sessionStorage.getItem("ProxyCookies") || "{}")

function SaveCookies(){
  sessionStorage.setItem("ProxyCookies", JSON.stringify(CookieJar))
}

function GetDomain(url){
  try{
    return new URL(url).hostname
  }catch{
    return null
  }
}

function BuildProxyUrl(Target){
  try{
    if(!Target.startsWith("http"))Target="https://"+Target

    const Domain = GetDomain(Target)
    const CookieHeader = CookieJar[Domain] || ""

    const Encoded = ProxyBase + encodeURIComponent(Target)

    // Attach cookie header via custom header bridge
    Frame.setAttribute("data-cookie-domain", Domain)
    Frame.setAttribute("data-cookie-header", CookieHeader)

    return Encoded
  }catch{
    return ""
  }
}

function LoadPage(){
  const Raw=UrlInput.value.trim()
  if(!Raw)return
  const Full=BuildProxyUrl(Raw)
  if(!Full)return
  Frame.src=Full
}

// Intercept response headers via iframe load
Frame.addEventListener("load",()=>{
  try{
    const Domain = Frame.getAttribute("data-cookie-domain")
    if(!Domain)return

    // Read proxy-set cookie header
    const SetCookie = Frame.contentWindow?.document?.cookie

    if(SetCookie){
      CookieJar[Domain] = SetCookie
      SaveCookies()
    }

  }catch{}
})

GoBtn.onclick=LoadPage

UrlInput.addEventListener("keydown",function(Event){
  if(Event.key==="Enter")LoadPage()
})
</script>

</body>
</html>
